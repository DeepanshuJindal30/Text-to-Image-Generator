import React from "react";
import { AppBar, Toolbar, Button, Typography } from "@mui/material";
import { useNavigate } from "react-router-dom";
import { useDispatch } from "react-redux";
import { clearAuth } from "../redux/slices/authSlice";

export default function Navbar() {
  const navigate = useNavigate();
  const dispatch = useDispatch();

  const token = localStorage.getItem("token");
  const roles = JSON.parse(localStorage.getItem("roles") || "[]");

  const isAdmin = roles.includes("Admin");
  const isManager = roles.includes("Manager");
  const isUser = roles.includes("User");

  const handleLogout = () => {
    localStorage.clear();
    dispatch(clearAuth());
    navigate("/");
  };

  return (
    <AppBar position="static">
      <Toolbar>
        <Typography variant="h6" sx={{ flexGrow: 1 }}>
          Dashboard
        </Typography>

        {/* Show login/register only when not logged in */}
        {!token && (
          <>
            <Button color="inherit" onClick={() => navigate("/")}>
              Login
            </Button>
            <Button color="inherit" onClick={() => navigate("/register")}>
              Register
            </Button>
          </>
        )}

        {/* Show dashboard tabs after login based on role */}
        {token && (
          <>
            {(isAdmin || isManager) && (
              <Button color="inherit" onClick={() => navigate("/trustee")}>
                Trustee
              </Button>
            )}

            {(isAdmin || isUser) && (
              <Button color="inherit" onClick={() => navigate("/sp")}>
                SP
              </Button>
            )}

            {isAdmin && (
              <Button color="inherit" onClick={() => navigate("/aml")}>
                AML
              </Button>
            )}

            <Button color="inherit" onClick={handleLogout}>
              Logout
            </Button>
          </>
        )}
      </Toolbar>
    </AppBar>
  );
}





import React from "react";
import { Routes, Route } from "react-router-dom";
import Login from "./components/Login";
import AMLList from "./components/AMLList";
import TrusteeList from "./components/TrusteeList";
import SPList from "./components/SPList";
import Register from "./components/Register";
import Navbar from "./components/Navbar"; // ✅ Import

export default function App() {
  return (
    <div>
      <Navbar /> {/* ✅ Use the dynamic navbar */}

      <Routes>
        <Route path="/" element={<Login />} />
        <Route path="/aml" element={<AMLList />} />
        <Route path="/trustee" element={<TrusteeList />} />
        <Route path="/sp" element={<SPList />} />
        <Route path="/register" element={<Register />} />
      </Routes>
    </div>
  );
}